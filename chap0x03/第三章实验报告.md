# 第三章实验报告
## 实验环境
+ 虚拟机：**Ubuntu 20.04 server 64bit**
+ 软件：**asciinema** && **powershell**
## 实验目的
+ 熟悉systemed操作
+ 进一步了解整体系统架构
## 实验过程
### 一、学习systemed入门教程：命令篇
1. systemd3.3-3.5
   [![asciicast](https://asciinema.org/a/w2wUe1FVbrdIUfdWJychlkyJQ.svg)](https://asciinema.org/a/w2wUe1FVbrdIUfdWJychlkyJQ)

2. systemd3.5-4.1
   [![asciicast](https://asciinema.org/a/0avVCK5myrAukGCNWUmo2W2Zy.svg)](https://asciinema.org/a/0avVCK5myrAukGCNWUmo2W2Zy)

3. systemd4.2-4.4
   [![asciicast](https://asciinema.org/a/IS9oX9RIPtvngbfWhy6RtYihd.svg)](https://asciinema.org/a/IS9oX9RIPtvngbfWhy6RtYihd)

4. systemd5.1-6
   [![asciicast](https://asciinema.org/a/8cbDFfhMvYmjq6bYavFabv08d.svg)](https://asciinema.org/a/8cbDFfhMvYmjq6bYavFabv08d)

5. systemd7
   [![asciicast](https://asciinema.org/a/vKdOg3UjGByYC7WNFthV256y9.svg)](https://asciinema.org/a/vKdOg3UjGByYC7WNFthV256y9)

### 二、学习systemed入门教程：实践篇

[![asciicast](https://asciinema.org/a/EKOR01zDzLHMOape0tQ1DdBhV.svg)](https://asciinema.org/a/EKOR01zDzLHMOape0tQ1DdBhV)

### 三、自查清单
1. 如何添加一个用户并使其具备sudo执行程序的权限？

- `adduser <username>`

- `usermod -G sudo -a <username>`

2. 如何将一个用户添加到一个用户组？

- `usermod -a -G <groupname> <username>`

3. 如何查看当前系统的分区表和文件系统详细信息？

- `df -h` 
- `gdisk -l`
- `fdisk -l`
- `parted -l`
- `lsblk -f`
  
4. 如何实现开机自动挂载Virtualbox的共享目录分区？

    在Windows下和虚拟机中分别创建共享文件夹，在虚拟机中挂载命令```sudo mount -t vboxsf <dirname> /mnt/dirname```，最后在/etc/fstab中把共享文件夹添加进去，完毕。

5. 基于LVM（逻辑分卷管理）的分区如何实现动态扩容和缩减容量？
   
   - `lvextand -L +<size> <dirname>`动态扩容
   - `lvreduce -L -<size> <dirname>`缩减容量

6. 如何通过systemd设置实现在网络连通时运行一个指定脚本，在网络断开时运行另一个脚本？
   - `ExecStartPost=<指定脚本位置> post1`
   - `ExecStopPost=<指定脚本位置> post2`
   - `sudo systemctl daemon-reload`
   - `sudo systemctl restart httpd.service`
7. 如何通过systemd设置实现一个脚本在任何情况下被杀死之后会立即重新启动？实现杀不死
   - `Restart=always`
   - `sudo systemctl daemon-reload`

## 错误纠正

- 设置当前时区时失败
```
$ sudo timedatectl set-time YYYY-MM-DD

$ sudo timedatectl set-time HH:MM:SS
```


- 解决方法：
先执行命令
`timedatectl set-ntp no`再设置时区，成功

## 参考资料
+ [Systemd 入门教程：命令篇](http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html)
+ [Systemd 入门教程：实战篇](http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html)
